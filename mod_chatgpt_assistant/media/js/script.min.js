/*------------------------------------------------------------------------
# mod_chatgpt_assistant - ChatGPT Assistant
# ------------------------------------------------------------------------
# author    Christopher Mavros - Mavrosxristoforos.com
# copyright Copyright (C) 2011 Mavrosxristoforos.com. All Rights Reserved.
# @license - http://www.gnu.org/licenses/gpl-2.0.html GNU/GPL
# Websites: https://mavrosxristoforos.com
# Technical Support:  Forum - https://mavrosxristoforos.com/support/forum
-------------------------------------------------------------------------*/ jQuery(document).ready(function(a){a("#chatgpt_assistant_button").click(function(){var s;a("#chatgpt_assistant_interface").slideToggle(),0==a("#chatgpt_assistant_interface .conversation-container .message").length&&(a("#chatgpt_assistant_interface .conversation-container").append('<div class="message_wrapper"><div class="message pending-message"><div class="ca-dot-typing-wrapper"><div class="ca-dot-typing"></div></div></div></div>'),setTimeout(function(){a("#chatgpt_assistant_interface .conversation-container .pending-message").remove(),a("#chatgpt_assistant_interface .conversation-container").append("<div class='message_wrapper'><div class='message received-message system-message'>"+Joomla.getOptions("mod_chatgpt_assistant").initial_system_message+"</div></div>");var s=a("#chatgpt_assistant_interface .conversation-container")[0];s.scrollTop=s.scrollHeight},300)),(s=a("#chatgpt_assistant_interface .conversation-container")[0]).scrollTop=s.scrollHeight,a("#ca_message").focus()}),a(".chatgpt_assistant_wrapper .input-container button").click(s),a(".chatgpt_assistant_wrapper .input-container input").keypress(function(a){13===a.which&&s()});function s(){var s=a("#ca_message").val();if(""!==s.trim()){var e=a("<div>").text(s).html();a("#chatgpt_assistant_interface .conversation-container").append('<div class="message_wrapper"><div class="message sent-message">'+e+"</div></div>"),a("#chatgpt_assistant_interface .conversation-container").append('<div class="message_wrapper"><div class="message pending-message"><div class="ca-dot-typing-wrapper"><div class="ca-dot-typing"></div></div></div></div>');var t=a("#chatgpt_assistant_interface .conversation-container")[0];t.scrollTop=t.scrollHeight,a.ajax({url:"index.php?option=com_ajax&module=chatgpt_assistant&method=sendMessage&format=json",method:"POST",data:{message:s,module_id:a(".chatgpt_assistant_wrapper").data("moduleId")},success:function(s){s.hasOwnProperty("data")?(s.data.hasOwnProperty("error")?(console.error(s.data.error),a("#chatgpt_assistant_interface .conversation-container").append("<div class='message_wrapper'><div class='message error-message system-message'>"+s.data.error+"</div></div>")):s.data.hasOwnProperty("output")?a("#chatgpt_assistant_interface .conversation-container").append("<div class='message_wrapper'><div class='message received-message'>"+s.data.output+"</div></div>"):(console.log(Joomla.JText._("MOD_CHATGPT_ASSISTANT_NO_OUTPUT_PROPERTY_IN_RESPONSE")),a("#chatgpt_assistant_interface .conversation-container").append("<div class='message_wrapper'><div class='message error-message'>"+Joomla.JText._("MOD_CHATGPT_ASSISTANT_SOMETHING_WENT_WRONG")+"</div></div>")),s.data.hasOwnProperty("warning")&&a("#chatgpt_assistant_interface .conversation-container").append("<div class='message_wrapper'><div class='message received-message system-message warning-message'>"+s.data.warning+"</div></div>")):(console.log(Joomla.JText._("MOD_CHATGPT_ASSISTANT_NO_DATA_PROPERTY_IN_RESPONSE")),a("#chatgpt_assistant_interface .conversation-container").append("<div class='message_wrapper'><div class='message error-message'>"+Joomla.JText._("MOD_CHATGPT_ASSISTANT_SOMETHING_WENT_WRONG")+"</div></div>"));var e=a("#chatgpt_assistant_interface .conversation-container")[0];e.scrollTop=e.scrollHeight},error:function(s,e,t){console.error(t),a("#chatgpt_assistant_interface .conversation-container").append("<div class='message_wrapper'><div class='message error-message'>"+t+"</div></div>");var n=a("#chatgpt_assistant_interface .conversation-container")[0];n.scrollTop=n.scrollHeight},complete:function(){a("#chatgpt_assistant_interface .conversation-container .pending-message").remove()}}),a(".input-container input").val("")}}});